# 09. 유연한 설계

Created: 2021년 3월 4일
Created by: Seha Jyang

## 개방 폐쇄 원칙

소프트웨어 개체(클래스, 모듈 등) 은 확장에 열려있어야 하고 수정에 대해선 닫혀있어야 한다.

핵심은 추상화에 의존하는 것이다.

- 폐쇄를 가능하게 하는 것은 의존성의 방향이다.
- 수정에 대한 영향을 최소화하기 위해선 모든 요소가 추상화에 의존해야한다.
- 변경에 의한 파급효과를 피하기 위해선 **변하는것과 변하지 않는것이 무엇인지 이해해야한다.**

## 생성 사용 분리

- 객체 생성에 대한 개방은 과도한 결합도를 초래한다.
- 객체와 관련된 두가지 책임을 서로 다른 객체로 분리해야 한다.
    - 객체에 대한 **생성과 사용을 분리** 해야한다.

### FACTORY 추가하기

생성과 사용을 분리하기 위해 객체 생성에 특화된 객체를 FACTORY 라고 부른다.

어떤 행동을 추가하려 하는데 이 행동을 책임질 마땅한 도메인 개념이 존재하지 않는다면 PURE FABRICATION을 추가하고 이 객체에게 책임을 할당하라.

## 의존성 주입

사용하는 객체가 아닌 외부의 독립적인 객체가 인스턴스를 생성한 후 이를 전달해서 의존성을 해결하는 방법을 의존성 주입(DI) 라고 부른다.

- 외부에서 의존성의 대상을 해결한 후 이를 사용하는 객체쪽으로 주입한다.
- 의존성을 해결하기 위해 의존성을 객체의 퍼블릭 인터페이스에 드러내서 외부에서 필요한 런타임 의존성을 전달할 수 있도록 만드는 방법을 포괄한다.

```java
* 생성자 주입 : 객체를 생성하는 시점에 생성자를 통한 의존성 해결
* setter 주입 : 객체 생성 후 setter 메서드를 통한 의존성 해결
* 메서드 주입 : 메서드 실행 시 파라미터를 통한 의존성 해결
	* 메서드가 의존성을 필요로 하는 유일한 경우일 때 사용할 수 있다.
```

- 의존성을 구현 내부로 감추는 SERVICE LOCATOR 패턴은 좋지않으며 캡슐화를 위배한다.

## 의존성 역전 원칙

### 추상화와 의존성 역전(DIP)

- 상위 수준 모듈은 하위 수준 모듈에 의존해선 안된다. 둘다 추상화에 의존해야 한다.
- 추상화는 구체적인 사항에 의존하면 안된다.

### SEPARATED INSTERFACE 패턴

추상화를 별도의 독립적인 패키지가 아닌, 클라이언트가 속한 패키지에 포함시키고

재사용 될 필요가 없는 클래스는 별도의 독립적 패키지에 모아야 한다.