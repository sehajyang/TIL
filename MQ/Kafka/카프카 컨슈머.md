# 카프카 컨슈머

Created: 2021년 7월 3일
Created by: Seha Jyang

## 특징

다른 MQ 시스템과는 다르게 컨슈머가 메세지를 가져가도 큐 내부 데이터가 사라지지 않음

데이터를 polling 방식으로 가져옴

## 역할

- 토픽 내부의 파티션으로부터 데이터 polling
- offset 위치 기록(commit)
    - 데이터를 컨슈머가 가져가게 되면 commit 한다.
    - commit 한 데이터에 대한 정보는 `__consumer_offset` 토픽에 저장된다.
        - 컨슈머 그룹별로 offset 나눠서 저장한다.
- 컨슈머 그룹을 통해 병렬처리
    - 컨슈머 그룹
        - 다른 컨슈머 그룹에 영향을 미치지 않는다.

## 구현

- 특정 토픽의 전체 파티션이 아니라 일부 파티션 데이터만 가져오고싶다면 `assign()` 사용
- 카프카 컨슈머 polling loop
    - `poll()` 가 포함된 무한루프

## 주의할 점

- 만약 파티션보다 컨슈머가 많은 경우 컨슈머는 놀게된다.
- 병렬처리 하고싶다면 `파티션 수 >= 컨슈머 수`